<!-- Imports polymer -->
<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/paper-card/paper-card.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/app-layout/app-layout.html">
<link rel="import" href="../bower_components/app-layout/app-toolbar/app-toolbar.html">
<link rel="import" href="../bower_components/app-layout/app-scroll-effects/effects/waterfall.html">
<link rel="import" href="../bower_components/paper-checkbox/paper-checkbox.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/paper-radio-button/paper-radio-button.html">
<link rel="import" href="../bower_components/paper-radio-group/paper-radio-group.html">
<link rel="import" href="../bower_components/iron-pages/iron-pages.html">


<!-- Defines element markup -->
<dom-module id="home-page">
    <style>
        #page {
            background-color: #F5F5F5;
            height: 100%;
        }

        paper-card {
            color: #B0BEC5;
            display: block;
            width: calc(100% - 32px);
            background-color: #EEEEEE;
            margin: 16px;
            
        }

        app-toolbar {
            background-color: #81D4FA;
            @apply(--shadow-elevation-4dp);
            margin-bottom: 4px;
        }

        .main-title {
            text-align: center;
            width: 100%;
            font-size: 24px;
        }

        .section-title {
            padding: 16px;
            background-color: #81D4FA;
            color: #000000;
        }

        #survey_container {
            height: calc(100% - 136px);
            color: #EEEEEE;
            overflow-y: auto;
        }

        paper-checkbox {
            --paper-checkbox-checked-color: #81D4FA;
            white-space: auto;
            --paper-checkbox-label : {
                width: calc(100% - 18px);
            };
            width: calc(100% - 16px);
            padding: 16px;
        }

        paper-button {
            color: #81D4FA;
            width: calc(100% - 24px);
            height: 50px;
            background-color: #FFFFFF;
            font-size: 16px;
            font-weight: bold;
            margin: 12px;
            position: absolute;
            z-index: 10;
            bottom: 0px;
        }

        paper-radio-button {
            --paper-radio-button-checked-color: #81D4FA;
        }

        paper-button:hover {
            background-color: #E1F5FE;
        }

        #submit {
            @apply(--shadow-elevation-2dp);
        }

    </style>
    <template>
        <div id="page">
            <app-header effects="waterfall">
                <app-toolbar>
                    <div main-title class="main-title">Rehab Resources</div>
                </app-toolbar>
            </app-header>
            <div id="survey_container">
            <iron-pages id="survey_pages" selected="[[ current_page ]]">
                <div id="survey_page_one">
                    <paper-card id="drugs">
                        <div class="section-title">Drugs</div>
                        <template is="dom-repeat" items="[[ drugs ]]" as="drug">
                            <paper-checkbox >[[ drug ]]</paper-checkbox>
                        </template>
                    </paper-card>
                    <paper-card id="symptoms" hidden>
                        <div class="section-title">Symptoms</div>
                        <template is="dom-repeat" items="[[ symptoms ]]" as="symptom">
                            <paper-checkbox >[[ symptom ]]</paper-checkbox>
                        </template>
                    </paper-card>
                    <paper-card>
                        <div class="section-title">Gender</div>
                            <paper-radio-group id="gender">
                                <paper-radio-button name="male">Male</paper-radio-button><br>
                                <paper-radio-button name="female">Female</paper-radio-button>
                            </paper-radio-group>
                    </paper-card>
                    <paper-card>
                        <div class="section-title">Ethnicity</div>
                            <paper-radio-group id="ethnicity">
                                <paper-radio-button name="white">White/Caucasian</paper-radio-button><br>
                                <paper-radio-button name="black">Black/African-American</paper-radio-button><br>
                                <paper-radio-button name="hispanic">Hispanic</paper-radio-button><br>
                                <paper-radio-button name="asian">Asian</paper-radio-button><br>
                                <paper-radio-button name="native">Native American</paper-radio-button><br>
                                <paper-radio-button name="other">Other</paper-radio-button>
                            </paper-radio-group>
                    </paper-card>
                    <paper-card>
                        <div class="section-title">Age</div>
                            <paper-radio-group id="age">
                                <paper-radio-button name="18_to_30">18-30 years old</paper-radio-button><br>
                                <paper-radio-button name="31_to_50">31-50 years old</paper-radio-button><br>
                                <paper-radio-button name="50_plus">50+ years old</paper-radio-button><br>
                            </paper-radio-group>
                    </paper-card>
                </div>
            </iron-pages>
            </div>
            <paper-button id="submit" on-tap="submit">[[ button_text ]]</paper-button>
        </div>
    </template>
</dom-module>

<!-- Registers custom element -->
<script>
Polymer({
    is: 'home-page',
    properties: {
        drugs: {
            type: Array,
            value: ["Alcohol", "Cocaine",
                    "Crack Cocaine", "Heroin", "Methamphetamine",
                    "Hydrocodone (Hysingla ER, Zohydro ER) ",
                    "Hydrocodone/Acetaminophen (Lorcet, Lortab, Norco, Vicodin)",
                    "Fentanyl (Actiq, Duragesic, Fentora)", "Hydromorphone (Dilaudid, Exalgo)",
                    "Meperidine (Demerol)", "Methadone (Dolophine, Methadose)",
                    "Morphine (Astramorph, Avinza, Kadian, MS Contin, Ora-Morph SR)",
                    "Oxycodone (OxyContin, Oxecta, Roxicodone)",
                    "Oxycodone and Acetaminophen (Percocet, Endocet, Roxicet)",
                    "Oxycodone and Naloxone (Targiniq ER)",
                    "Solvents (aerosols, gases and glues)"]
        },
        symptoms: {
            type: Array,
            value: ["Constipation", "Drowsiness",
                    "Nausea", "Vomiting", "Diarrhea", "Muscle Pain",
                    "Anxiety", "Irritability", "Headache", "Difficulty concentrating", 
                    "Tremors", "Disturbed sleep", "Irregular heart rate",
                    "Panic attacks", "Sweating"]
        },
        button_text: {
            type: String,
            value: 'NEXT (1/3)'
        },
        all_drugs_checked: {
            type: Boolean,
            value: false
        },
        all_symptoms_checked: {
            type: Boolean,
            value: false
        },
        current_page: {
            type: Number,
            value: 0
        }
    },

//     select_all_drugs: function () {
//         this.all_drugs_checked = !this.all_drugs_checked;
//         var checkboxes = this.$.drugs_list.querySelectorAll('paper-checkbox');
//         for(var i=0; i < checkboxes.length; i++) {
//             checkboxes[i].checked = this.all_drugs_checked;
//         }
//     },

//     select_all_symptoms: function () {
//         this.all_symptoms_checked = !this.all_symptoms_checked;
//         var checkboxes = this.$.symptoms_list.querySelectorAll('paper-checkbox');
//         for(var i=0; i < checkboxes.length; i++) {
//             checkboxes[i].checked = this.all_symptoms_checked;
//         }
//     },

    submit: function () {
        var payload = {
                drugs: this.get_checked_boxes(this.$.drugs.querySelectorAll('paper-checkbox')),
                symptoms: this.get_checked_boxes(this.$.symptoms.querySelectorAll('paper-checkbox')),
                gender: this.$.gender.selected,
                ethnicity: this.$.ethnicity.selected,
                age: this.$.age.selected
        };
        this.fire('query', payload);
    },

    get_checked_boxes: function(checkboxes) {
        var checked = [];
        checkboxes.forEach(function(checkbox) {
            if(checkbox.checked) {
                checked.push(checkbox.querySelector('#checkboxLabel').innerHTML);
            }
        });
        console.log(checked)
        return checked;
    }
});
</script>
